# Lab 3-1 Requirements Checklist

## ✅ Part 1: Session Management (maintaining identity) & Admin Privileges (authorisation)

### Deliverables: Session management and privilege-checking functionality in `settings/core.php`

- [x] **Task 1.1**: Ensure session is started
  - ✅ `session_start()` is called in `settings/core.php` (line 2)

- [x] **Task 1.2**: Implement `is_logged_in()` to check if a session exists
  - ✅ Function implemented in `settings/core.php` (lines 5-7)
  - ✅ Checks `$_SESSION['customer']` is set and not empty

- [x] **Task 1.3**: Implement `is_admin()` to check user's administrative privileges from the session array
  - ✅ Function implemented in `settings/core.php` (lines 10-12)
  - ✅ Checks `$_SESSION['customer']['user_role'] == 1`

---

## ✅ Part 2: Category Management – CRUD operations

### Deliverables: Fully implemented category management

### Admin (`admin/category.php`)

- [x] **Task 2.1**: Check if the user is logged in and is an admin; redirect to login if not
  - ✅ Implemented in `admin/category.php` (lines 6-15)
  - ✅ Uses `is_logged_in()` and `is_admin()` functions
  - ✅ Redirects to login if not admin

- [x] **Task 2.2**: RETRIEVE - Display categories (only those created by the logged-in user)
  - ✅ Categories table displayed in `admin/category.php`
  - ✅ `fetch_category_action.php` filters by `user_id`
  - ✅ `category_class.php::getAll()` filters by logged-in user's ID

- [x] **Task 2.3**: CREATE - Form for category name (ID autogenerated, name unique)
  - ✅ Add category form in `admin/category.php` (lines 137-147)
  - ✅ ID is auto-generated by database (`cat_id` AUTO_INCREMENT)
  - ✅ Name uniqueness checked in `category_class.php::nameExists()`

- [x] **Task 2.4**: UPDATE - Display style is flexible, but should collect updated name (ID not editable)
  - ✅ Edit category form in `admin/category.php` (lines 152-170)
  - ✅ ID is hidden input field (not editable)
  - ✅ Updates only the name field

- [x] **Task 2.5**: DELETE - Delete a category
  - ✅ Delete functionality in `public/js/category.js` (lines 191-215)
  - ✅ Calls `delete_category_action.php` asynchronously

### Actions/Functions

- [x] **Task 2.6**: `fetch_category_action.php` - Fetch categories created by a user
  - ✅ File exists: `actions/fetch_category_action.php`
  - ✅ Filters categories by logged-in user's `customer_id`
  - ✅ Returns JSON response

- [x] **Task 2.7**: `add_category_action.php` - Receive data from form, invoke controller, return message
  - ✅ File exists: `actions/add_category_action.php`
  - ✅ Receives POST data, invokes `CategoryController::add_category_ctr()`
  - ✅ Returns JSON response with success/error message

- [x] **Task 2.8**: `update_category_action.php` - Receive data from form, invoke controller, return message
  - ✅ File exists: `actions/update_category_action.php`
  - ✅ Receives POST data (id, name), invokes `CategoryController::update()`
  - ✅ Returns JSON response with success/error message

- [x] **Task 2.9**: `delete_category_action.php` - Receive ID/name, invoke controller, return message
  - ✅ File exists: `actions/delete_category_action.php`
  - ✅ Receives POST data (id), invokes `CategoryController::delete()`
  - ✅ Returns JSON response with success/error message

### Classes/Models (`category_class.php`)

- [x] **Task 2.10**: Extend database connection
  - ✅ `Category` class uses `Database` class in constructor
  - ✅ Calls `$this->db->connect()` to establish connection

- [x] **Task 2.11**: Implement methods: add category, edit category, delete category, get category
  - ✅ `create($name, $user_id)` - Add category (line 19)
  - ✅ `update($id, $name)` - Edit category (line 107)
  - ✅ `delete($id)` - Delete category (line 113)
  - ✅ `getAll($user_id)` - Get all categories (line 47)
  - ✅ `getById($id)` - Get single category (line 100)

### Controllers (`category_controller.php`)

- [x] **Task 2.12**: Create instance of `Category` class
  - ✅ Constructor creates `Category` instance (line 8)

- [x] **Task 2.13**: Implement `add_category_ctr($kwargs)` to invoke `category_class::add($args)`
  - ✅ Method implemented (lines 12-29)
  - ✅ Accepts `$kwargs` array with `name` and `user_id`
  - ✅ Invokes `$this->category->create($name, $user_id)`

### JS (`public/js/category.js`)

- [x] **Task 2.14**: Validate category information (type, length, characters)
  - ✅ `validateCategoryName()` function (lines 2-25)
  - ✅ Checks: not empty, is string, length (2-100 chars), valid characters (alphanumeric, spaces, hyphens)

- [x] **Task 2.15**: Asynchronously invoke action scripts and inform user via pop-up/modal
  - ✅ All CRUD operations use `fetch()` API (async/await)
  - ✅ `loadCategories()` - async fetch (line 50)
  - ✅ Add category form - async fetch (line 105)
  - ✅ Update category form - async fetch (line 163)
  - ✅ Delete category - async fetch (line 199)
  - ✅ `showModal()` function displays pop-up messages (lines 28-47)

### `index.php`

- [x] **Task 2.16**: Update menu:
  - **Not logged in**: Register | Login
    - ✅ Implemented (lines 124-125)
  - **Logged in and admin**: Logout | Category (navigates to `admin/category.php`)
    - ✅ Implemented (lines 118-119)
  - **Logged in and not admin**: Logout
    - ✅ Implemented (line 121)

---

## Summary

✅ **All Lab 3-1 requirements have been met!**

- Part 1 (Session Management & Admin Privileges): ✅ Complete
- Part 2 (Category Management CRUD): ✅ Complete

All required files, functions, and functionalities are implemented and working correctly.

